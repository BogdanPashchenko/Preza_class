:imagesdir: photo

== Конструктор и как с ним работать

Конструктор — функция, предназначенная для инициализации объектов класса.

В объектно-ориентированном программировании конструктор класса — специальный блок инструкций, вызываемый при создании объекта.

В отличие от обычных методов, конструкторы имеют определённые правила по поводу их имён:

1)Конструкторы всегда должны иметь то же имя, что и класс (учитываются верхний и нижний регистры).

2)Конструкторы не имеют типа возврата (даже void-а).

=== Конструктор по умолчанию

Конструктором по умолчанию называется конструктор, который не имеет параметров (или имеет параметры, все из которых имеют значения по
умолчанию

image::_1.png[]


Этот класс содержит дробь в виде отдельных значений типа int. Конструктор по умолчанию называется Fraction (как и класс). Поскольку мы создали объект класса Fraction без аргументов, то конструктор по умолчанию сработал сразу же после выделения памяти для объекта, и инициализировал наш объект.

=== Конструктор с параметрами

Хотя конструктор по умолчанию отлично подходит для обеспечения инициализации наших классов значениями по умолчанию, часто может быть нужно, чтобы экземпляры нашего класса имели определённые значения, которые мы предоставим позже. К счастью, конструкторы также могут быть объявлены с параметрами. Вот пример конструктора, который имеет два целочисленных параметра, которые используются для инициализации числителя и знаменателя:

image::_2.png[]


Обратите внимание, теперь у нас есть два конструктора: конструктор по умолчанию, который будет вызываться, если мы не предоставим значения, и конструктор с параметрами, который будет вызываться, если мы предоставим значения. Эти два конструктора могут мирно существовать в одном классе благодаря перегрузке функций. Фактически, вы можете определить любое количество конструкторов до тех пор, пока у них будут уникальные параметры (учитывается их количество и тип).

Использовать конструктор с параметрами можно несколькими способами:
1) Инизиализация прямая

image::_3.png[]

2) Uniform инициализация

image::_4.png[]

=== Неявно генерируемый конструктор по умолчанию

Если ваш класс не имеет других конструкторов, то C++ автоматически сгенерирует для вашего класса открытый конструктор по умолчанию. Его иногда называют неявным конструктором (или ещё «неявно сгенерированным конструктором»).

image::_5.png[]

Этот конструктор позволяет создавать объекты класса, но не выполняет их инициализацию и не присваивает значения членам класса.

=== Классы, содержащие другие классы

Одни классы могут содержать другие классы в качестве переменных-членов. По умолчанию, при создании внешнего класса, для переменных-членов будут вызываться конструкторы по умолчанию. Это произойдёт до того, как тело конструктора выполнится. 

image::Screenshot_6.png[]

При создании переменной b вызывается конструктор B(). Прежде чем тело конструктора выполнится, m_a инициализируется, вызывая конструктор по умолчанию класса A. Таким образом выведется A. Затем управление возвратится обратно к конструктору B, и тело конструктора B начнёт своё выполнение.

Здесь есть смысл, так как конструктор B() может захотеть использовать переменную m_a, поэтому сначала нужно инициализировать m_a!

*Правила работы с конструкторами:*

1) Используйте прямую или uniform инициализацию с объектами ваших классов. 

2) Не используйте копирующую инициализацию с объектами ваших классов.

3) Создавайте хотя бы один конструктор в классе, даже если это пустой конструктор по умолчанию.


=== Деструкторы

В работе с конструкторами периодически сталкивается термин деструкторы

Определяемый пользователем класс имеет конструктор, который обеспечивает надлежащую инициализацию. Для многих типов также требуется обратное действие. Деструктор обеспечивает соответствующую очистку объектов указанного типа. Имя деструктора представляет собой имя класса с предшествующим ему знаком «тильда» ~. Так, для класса X деструктор будет иметь имя ~X(). Многие классы используют динамическую память, которая выделяется конструктором, а освобождается деструктором.

image::_7.png[]
